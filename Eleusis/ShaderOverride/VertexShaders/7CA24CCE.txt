//
// Generated by Microsoft (R) HLSL Shader Compiler 9.29.952.3111
//
// Parameters:
//
//   float4x4 Transform;
//
//
// Registers:
//
//   Name         Reg   Size
//   ------------ ----- ----
//   Transform    c6       4
//

    vs_3_0
    dcl_position v0
    dcl_texcoord v1
    dcl_color v2
    dcl_texcoord o0.xy
    dcl_color o1
    dcl_position o2

def c220, 0, 1, 0.0625, 0.5
dcl_2d s3

    mul r0, c7, v0.y
    mad r0, c6, v0.x, r0
    mad r0, c8, v0.z, r0
    mad r1, c9, v0.w, r0
    mov o0.xy, v1
    mov o1, v2.zyxw

// approximately 6 instruction slots used

texldl r31, c220.z, s3

// The normal UI depth adjustment below misaligns the drop shadow
//mad r1.x, r31.x, c200.z, r1.x

// Instead, we multiply the entire output coordinate to achieve the same depth,
// but without the misalignment.

// In order to calculate how much we need to multiply the coordinate by, we
// need to take the stereo adjustment formula (including the perspective divide
// by W) and the UI depth adjustment formula (where we assume W=1 for the
// perspective divide), set them equal and solve for W:
// S * (W - C) / W = S * UI / 1
// W = -C / (UI - 1)

mov r31.w, c200.z		// UI
add r31.w, r31.w, -c220.y	// UI - 1
rcp r31.w, r31.w		// 1 / (UI - 1)
mul r31.w, -r31.y, r31.w	// -C / (UI - 1)

mul o2, r1, r31.w
